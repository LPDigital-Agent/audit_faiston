(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4370,e=>{"use strict";var t=e.i(49973),s=e.i(47163),a=e.i(69742);let r={none:"",sm:"p-3",md:"p-4",lg:"p-6"};function i({ref:e,className:i,elevated:l=!1,gradientBorder:n=!1,hoverGlow:o=!0,padding:d="md",children:c,...u}){return(0,t.jsx)(a.motion.div,{ref:e,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,ease:"easeOut"},className:(0,s.cn)(l?"glass-elevated":"glass-card",r[d],o&&"ghost-border",n&&"gradient-border","transition-all duration-200",i),...u,children:c})}function l({className:e,children:a,...r}){return(0,t.jsx)("div",{className:(0,s.cn)("flex items-center justify-between mb-4",e),...r,children:a})}function n({className:e,children:a,...r}){return(0,t.jsx)("h3",{className:(0,s.cn)("text-h2 text-text-primary",e),...r,children:a})}function o({className:e,children:a,...r}){return(0,t.jsx)("div",{className:(0,s.cn)("text-body text-text-secondary",e),...r,children:a})}e.s(["GlassCard",()=>i,"GlassCardContent",()=>o,"GlassCardHeader",()=>l,"GlassCardTitle",()=>n])},66974,e=>{"use strict";let t=(0,e.i(98631).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],66974)},30209,e=>{"use strict";var t=e.i(18939),s=e.i(99973),a=e.i(89747),r=e.i(79743),i=e.i(4039),l=class extends r.Subscribable{#e;#t=void 0;#s;#a;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,i.shallowEqualObjects)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,i.hashKey)(t.mutationKey)!==(0,i.hashKey)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#i(e)}getCurrentResult(){return this.#t}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#r(),this.#i()}mutate(e,t){return this.#a=t,this.#s?.removeObserver(this),this.#s=this.#e.getMutationCache().build(this.#e,this.options),this.#s.addObserver(this),this.#s.execute(e)}#r(){let e=this.#s?.state??(0,s.getDefaultState)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#i(e){a.notifyManager.batch(()=>{if(this.#a&&this.hasListeners()){let t=this.#t.variables,s=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#a.onSuccess?.(e.data,t,s,a),this.#a.onSettled?.(e.data,null,t,s,a)):e?.type==="error"&&(this.#a.onError?.(e.error,t,s,a),this.#a.onSettled?.(void 0,e.error,t,s,a))}this.listeners.forEach(e=>{e(this.#t)})})}},n=e.i(63257);function o(e,s){let r=(0,n.useQueryClient)(s),[o]=t.useState(()=>new l(r,e));t.useEffect(()=>{o.setOptions(e)},[o,e]);let d=t.useSyncExternalStore(t.useCallback(e=>o.subscribe(a.notifyManager.batchCalls(e)),[o]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),c=t.useCallback((e,t)=>{o.mutate(e,t).catch(i.noop)},[o]);if(d.error&&(0,i.shouldThrowError)(o.options.throwOnError,[d.error]))throw d.error;return{...d,mutate:c,mutateAsync:d.mutate}}e.s(["useMutation",()=>o],30209)},54754,e=>{"use strict";let t=(0,e.i(98631).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],54754)},43675,e=>{"use strict";let t=(0,e.i(98631).default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);e.s(["Camera",()=>t],43675)},52989,e=>{"use strict";let t=(0,e.i(98631).default)("warehouse",[["path",{d:"M18 21V10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v11",key:"pb2vm6"}],["path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 1.132-1.803l7.95-3.974a2 2 0 0 1 1.837 0l7.948 3.974A2 2 0 0 1 22 8z",key:"doq5xv"}],["path",{d:"M6 13h12",key:"yf64js"}],["path",{d:"M6 17h12",key:"1jwigz"}]]);e.s(["Warehouse",()=>t],52989)},44785,e=>{"use strict";var t=e.i(49973),s=e.i(18939),a=e.i(91514),r=e.i(30209),i=e.i(4370),l=e.i(67881),n=e.i(23750),o=e.i(48162),d=e.i(54754),c=e.i(16024),u=e.i(9020),m=e.i(51946),h=e.i(29126),x=e.i(66974),p=e.i(21172),b=e.i(52989),v=e.i(99688),g=e.i(49202),j=e.i(43675),N=e.i(64583);let y=[{value:"CUSTOMER",label:"Cliente"},{value:"FIELD_TECH",label:"Técnico de Campo"},{value:"BRANCH",label:"Filial"},{value:"THIRD_PARTY",label:"Terceiro"}],C=[{value:"FAISTON",label:"Faiston",color:"text-blue-400"},{value:"NTT",label:"NTT",color:"text-purple-400"},{value:"TERCEIROS",label:"Terceiros",color:"text-gray-400"}],f=[{value:"FUNCIONAL",label:"Funcional",color:"text-green-400"},{value:"DEFEITUOSO",label:"Defeituoso",color:"text-yellow-400"},{value:"INSERVIVEL",label:"Inservível",color:"text-red-400"}],w=[{value:"CONSERTO_CONCLUIDO",label:"Conserto Concluído"},{value:"DEVOLUCAO_CLIENTE",label:"Devolução do Cliente"},{value:"FIM_CONTRATO",label:"Fim de Contrato"},{value:"UPGRADE",label:"Upgrade de Equipamento"},{value:"TROCA_GARANTIA",label:"Troca em Garantia"},{value:"EQUIPAMENTO_DEFEITUOSO",label:"Equipamento Defeituoso"},{value:"OUTRO",label:"Outro"}],O={"01":"Recebimento","03":"BAD (Defeituosos Faiston)","03.01":"BAD NTT (Defeituosos NTT)","04":"Descarte","05":"Itens de Terceiros","06":"Depósito de Terceiros"};function T(){let[e,T]=(0,s.useState)(""),[R,M]=(0,s.useState)("CUSTOMER"),[E,S]=(0,s.useState)(""),[A,k]=(0,s.useState)("FAISTON"),[I,D]=(0,s.useState)("FUNCIONAL"),[_,F]=(0,s.useState)("DEVOLUCAO_CLIENTE"),[U,P]=(0,s.useState)(""),[L,G]=(0,s.useState)(""),[q,H]=(0,s.useState)(""),[B,K]=(0,s.useState)(""),[z,V]=(0,s.useState)(null),[Q,W]=(0,s.useState)(null),[$,X]=(0,s.useState)(null),Y=(0,r.useMutation)({mutationFn:async()=>(await (0,N.validateReturnOrigin)({serial:e,claimed_origin:E})).data,onSuccess:e=>{e.found&&e.asset&&V(e.asset)}}),J=(0,r.useMutation)({mutationFn:async()=>(await (0,N.evaluateReturnCondition)({serial:e,owner:A,condition_description:B})).data,onSuccess:e=>{e.detected_condition&&D(e.detected_condition),e.recommended_depot&&W(e.recommended_depot)}}),Z=(0,r.useMutation)({mutationFn:async()=>(await (0,N.processReturnNew)({serial:e,origin_type:R,origin_address:E,owner:A,condition:I,return_reason:_,chamado_id:U||void 0,project_id:L||void 0,notes:q})).data,onSuccess:e=>{X({success:e.success,depot:e.destination_depot,depotName:e.destination_depot_name||O[e.destination_depot]||e.destination_depot,message:e.message,requiresAnalysis:e.requires_analysis})}}),ee=Z.isPending;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,t.jsxs)(a.default,{href:"/ferramentas/ativos/estoque/movimentacoes",children:[(0,t.jsx)(d.ArrowLeft,{className:"w-4 h-4 mr-1"}),"Movimentações"]})})}),(0,t.jsxs)("h1",{className:"text-xl font-semibold text-text-primary flex items-center gap-2",children:[(0,t.jsx)(o.RotateCcw,{className:"w-5 h-5 text-purple-400"}),"Reversa / Devolução"]}),(0,t.jsx)("p",{className:"text-sm text-text-muted mt-1",children:"Processar retorno de equipamentos com roteamento automático para depósito"})]})}),$&&$.success&&(0,t.jsx)(i.GlassCard,{children:(0,t.jsx)(i.GlassCardContent,{className:"py-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(h.CheckCircle2,{className:"w-12 h-12 text-green-400 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-lg font-semibold text-text-primary mb-2",children:"Reversa Processada!"}),(0,t.jsx)("p",{className:"text-text-muted mb-4",children:$.message}),(0,t.jsxs)("div",{className:"p-4 bg-white/5 border border-border rounded-lg inline-block",children:[(0,t.jsx)("p",{className:"text-sm text-text-muted",children:"Depósito de Destino:"}),(0,t.jsxs)("p",{className:"text-xl font-bold text-text-primary",children:[$.depot," - ",$.depotName]})]}),$.requiresAnalysis&&(0,t.jsxs)("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg",children:[(0,t.jsx)(p.AlertTriangle,{className:"w-4 h-4 text-yellow-400 inline mr-2"}),(0,t.jsx)("span",{className:"text-sm text-yellow-400",children:"Equipamento requer análise técnica antes de disponibilização"})]}),(0,t.jsx)(l.Button,{className:"mt-6",onClick:()=>{T(""),S(""),K(""),P(""),G(""),H(""),V(null),W(null),X(null),k("FAISTON"),D("FUNCIONAL"),F("DEVOLUCAO_CLIENTE"),M("CUSTOMER")},children:"Nova Reversa"})]})})}),(!$||!$.success)&&(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsx)("div",{className:"lg:col-span-2",children:(0,t.jsxs)(i.GlassCard,{children:[(0,t.jsx)(i.GlassCardHeader,{children:(0,t.jsx)(i.GlassCardTitle,{children:"Dados da Reversa"})}),(0,t.jsx)(i.GlassCardContent,{children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"text-sm font-medium text-text-primary mb-2 block",children:[(0,t.jsx)(u.Package,{className:"w-4 h-4 inline mr-1"}),"Número de Série *"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n.Input,{placeholder:"Digite ou escaneie o serial...",value:e,onChange:e=>T(e.target.value),className:"bg-white/5 border-border flex-1"}),(0,t.jsx)(l.Button,{variant:"outline",onClick:()=>{e&&Y.mutate()},disabled:!e||Y.isPending,children:Y.isPending?(0,t.jsx)(x.RefreshCw,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(c.Search,{className:"w-4 h-4"})})]}),z&&(0,t.jsx)("div",{className:"mt-2 p-2 bg-green-500/10 border border-green-500/30 rounded-md",children:(0,t.jsxs)("p",{className:"text-sm text-green-400",children:["✓ ",z.part_number," - ",z.description]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"text-sm font-medium text-text-primary mb-2 block",children:[(0,t.jsx)(v.User,{className:"w-4 h-4 inline mr-1"}),"Tipo de Origem"]}),(0,t.jsx)("select",{className:"w-full px-3 py-2 bg-white/5 border border-border rounded-md text-sm text-text-primary",value:R,onChange:e=>M(e.target.value),children:y.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"text-sm font-medium text-text-primary mb-2 block",children:[(0,t.jsx)(m.MapPin,{className:"w-4 h-4 inline mr-1"}),"Endereço de Origem"]}),(0,t.jsx)(n.Input,{placeholder:"Cidade, estado ou endereço...",value:E,onChange:e=>S(e.target.value),className:"bg-white/5 border-border"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"text-sm font-medium text-text-primary mb-2 block",children:[(0,t.jsx)(b.Warehouse,{className:"w-4 h-4 inline mr-1"}),"Proprietário do Equipamento"]}),(0,t.jsx)("select",{className:"w-full px-3 py-2 bg-white/5 border border-border rounded-md text-sm text-text-primary",value:A,onChange:e=>k(e.target.value),children:C.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-text-primary mb-2 block",children:"Condição"}),(0,t.jsx)("div",{className:"flex gap-2",children:f.map(e=>(0,t.jsx)("button",{type:"button",className:`flex-1 px-3 py-2 rounded-md text-sm border transition-all ${I===e.value?`bg-white/10 border-white/30 ${e.color}`:"bg-white/5 border-border text-text-muted hover:bg-white/10"}`,onClick:()=>D(e.value),children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"text-sm font-medium text-text-primary mb-2 block",children:[(0,t.jsx)(g.FileText,{className:"w-4 h-4 inline mr-1"}),"Motivo da Devolução"]}),(0,t.jsx)("select",{className:"w-full px-3 py-2 bg-white/5 border border-border rounded-md text-sm text-text-primary",value:_,onChange:e=>F(e.target.value),children:w.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-text-primary mb-2 block",children:"Chamado (opcional)"}),(0,t.jsx)(n.Input,{placeholder:"CHAMADO-12345",value:U,onChange:e=>P(e.target.value),className:"bg-white/5 border-border"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-text-primary mb-2 block",children:"Projeto (opcional)"}),(0,t.jsx)(n.Input,{placeholder:"ID do projeto",value:L,onChange:e=>G(e.target.value),className:"bg-white/5 border-border"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-text-primary mb-2 block",children:"Observações"}),(0,t.jsx)("textarea",{className:"w-full px-3 py-2 bg-white/5 border border-border rounded-md text-sm text-text-primary min-h-[80px] resize-none",placeholder:"Observações sobre a devolução...",value:q,onChange:e=>H(e.target.value)})]}),Z.error&&(0,t.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-500/20 border border-red-500/30 rounded-lg",children:[(0,t.jsx)(p.AlertTriangle,{className:"w-5 h-5 text-red-400"}),(0,t.jsx)("p",{className:"text-sm text-red-400",children:Z.error.message})]}),(0,t.jsx)(l.Button,{className:"w-full",disabled:!e||ee,onClick:()=>{e&&R&&Z.mutate()},children:ee?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.RefreshCw,{className:"w-4 h-4 mr-2 animate-spin"}),"Processando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.CheckCircle2,{className:"w-4 h-4 mr-2"}),"Processar Reversa"]})})]})})]})}),(0,t.jsx)("div",{children:(0,t.jsxs)(i.GlassCard,{children:[(0,t.jsx)(i.GlassCardHeader,{children:(0,t.jsxs)(i.GlassCardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(j.Camera,{className:"w-4 h-4"}),"Avaliação AI"]})}),(0,t.jsx)(i.GlassCardContent,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("p",{className:"text-sm text-text-muted",children:"Descreva o estado do equipamento para sugestão automática de depósito."}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-text-primary mb-2 block",children:"Descrição da Condição"}),(0,t.jsx)("textarea",{className:"w-full px-3 py-2 bg-white/5 border border-border rounded-md text-sm text-text-primary min-h-[100px] resize-none",placeholder:"Ex: Equipamento com tela rachada, liga mas não exibe imagem...",value:B,onChange:e=>K(e.target.value)})]}),(0,t.jsx)(l.Button,{variant:"outline",className:"w-full",disabled:!B||!e||J.isPending,onClick:()=>{B&&J.mutate()},children:J.isPending?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.RefreshCw,{className:"w-4 h-4 mr-2 animate-spin"}),"Analisando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Search,{className:"w-4 h-4 mr-2"}),"Avaliar com IA"]})}),Q&&(0,t.jsxs)("div",{className:"p-4 bg-purple-500/10 border border-purple-500/30 rounded-lg",children:[(0,t.jsx)("p",{className:"text-sm text-purple-400 font-medium mb-2",children:"Sugestão NEXO AI:"}),(0,t.jsxs)("p",{className:"text-lg font-bold text-text-primary",children:[Q," - ",O[Q]||Q]})]}),(0,t.jsxs)("div",{className:"pt-4 border-t border-border",children:[(0,t.jsx)("p",{className:"text-xs text-text-muted mb-2",children:"Depósitos SAP:"}),(0,t.jsx)("div",{className:"space-y-1 text-xs",children:Object.entries(O).map(([e,s])=>(0,t.jsxs)("div",{className:"flex justify-between text-text-muted",children:[(0,t.jsx)("span",{children:e}),(0,t.jsx)("span",{children:s})]},e))})]})]})})]})})]})]})}e.s(["default",()=>T])}]);